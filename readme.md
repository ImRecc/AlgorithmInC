有不同的分支对应算法4的不同部分，后续等某人接着搞
